define(["ojs/ojcore","knockout","jquery","appController","config/appconfig","ojs/ojdialog","ojs/ojformlayout","ojs/ojinputtext"],function(e,o,n,t,s){return new function(){var a=this,l=e.Router.rootInstance,r=s.get("baseURL"),i=s.get("loginEndpoint"),u=s.get("loginEnabled"),c=s.get("rewardsEnabled");u||t.userid(s.get("defaultUser")),a.username=new o.observable("user@email.com"),a.password=new o.observable(""),a.signUpMe=function(){console.log("sign up")},a.signInMe=function(){document.querySelector("#loginDialog").open()},a.login=function(){u?""==a.password()||null==a.password()?alert("Password cannot be empty. Please try again."):n.post(r+i,{username:a.username,password:a.password},function(e,o){"success"==o&&"success"==e.result?(t.userid(e.memberno),console.log(t.userid()),a.loginComplete()):(console.log("status: "+o+" result: "+e.result),alert("Incorrect username/password. Please try again."))}):a.loginComplete()},a.loginComplete=function(){document.querySelector("#loginDialog").close(),c?l.go("reward"):l.go("unavailable")},a.startAnimationListener=function(o){var t=o.detail;n(o.target).is(".oj-dialog")&&("open"===t.action?(o.preventDefault(),e.AnimationUtils.zoomIn(t.element,{duration:"400ms"}).then(t.endCallback)):"close"===t.action&&(o.preventDefault(),t.endCallback()))},a.connected=function(){},a.disconnected=function(){},a.transitionCompleted=function(){}}});
